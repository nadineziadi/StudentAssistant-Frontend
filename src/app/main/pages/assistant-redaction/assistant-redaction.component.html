<div class="redaction-container">
  <!-- TOAST NOTIFICATION -->
  <div class="toast-notification" *ngIf="showToast" [class.toast-success]="toastType === 'success'"
       [class.toast-error]="toastType === 'error'" [class.toast-info]="toastType === 'info'">
    <span class="toast-icon">
      <span *ngIf="toastType === 'success'">âœ“</span>
      <span *ngIf="toastType === 'error'">âœ•</span>
      <span *ngIf="toastType === 'info'">â„¹</span>
    </span>
    <span class="toast-message">{{ toastMessage }}</span>
    <button class="toast-close" (click)="closeToast()">Ã—</button>
  </div>

  <!-- HEADER -->
  <div class="redaction-header">
    <div class="header-content">
      <div class="icon-wrapper">
        <span class="header-icon">âœï¸</span>
      </div>
      <div class="header-text">
        <h1 class="page-title">Assistant RÃ©daction</h1>
        <p class="page-subtitle">Correction grammaticale et suggestions de style propulsÃ©es par IA</p>
      </div>
    </div>
    <div class="stats-badges" *ngIf="documents.length > 0">
      <div class="stat-badge">
        <span class="stat-value">{{ documents.length }}</span>
        <span class="stat-label">Documents</span>
      </div>
      <div class="stat-badge stat-success">
        <span class="stat-value">{{ getCorrectedCount() }}</span>
        <span class="stat-label">CorrigÃ©s</span>
      </div>
    </div>
  </div>

  <!-- MAIN NAVIGATION TABS -->
  <div class="main-tabs-container">
    <button class="main-tab-btn" [class.active]="activeMainTab === 'correction'"
      (click)="activeMainTab = 'correction'">
      <span class="tab-icon">ğŸ“</span>
      <div class="tab-text">
        <span class="tab-title">Correction ComplÃ¨te</span>
        <span class="tab-desc">Analyse approfondie</span>
      </div>
    </button>
    <!-- Dans la section MAIN NAVIGATION TABS -->
<button class="main-tab-btn" [class.active]="activeMainTab === 'style'"
  (click)="activeMainTab = 'style'">
  <span class="tab-icon">ğŸ­</span>
  <div class="tab-text">
    <span class="tab-title">Adaptation Style</span>
    <span class="tab-desc">Personnalisation</span>
  </div>
</button>
    <button class="main-tab-btn" [class.active]="activeMainTab === 'grammar'"
      (click)="activeMainTab = 'grammar'">
      <span class="tab-icon">âš¡</span>
      <div class="tab-text">
        <span class="tab-title">Correction Rapide</span>
        <span class="tab-desc">Grammaire instantanÃ©e</span>
      </div>
    </button>
    <button class="main-tab-btn" [class.active]="activeMainTab === 'translation'"
      (click)="activeMainTab = 'translation'">
      <span class="tab-icon">ğŸŒ</span>
      <div class="tab-text">
        <span class="tab-title">Traduction</span>
        <span class="tab-desc">FR â‡„ EN</span>
      </div>
    </button>
    <button class="main-tab-btn" [class.active]="activeMainTab === 'paraphrase'"
      (click)="activeMainTab = 'paraphrase'">
      <span class="tab-icon">ğŸ”„</span>
      <div class="tab-text">
        <span class="tab-title">Paraphrase</span>
        <span class="tab-desc">Reformulation</span>
      </div>
    </button>
    <button class="main-tab-btn" [class.active]="activeMainTab === 'history'"
      (click)="activeMainTab = 'history'; loadHistory()">
      <span class="tab-icon">ğŸ“š</span>
      <div class="tab-text">
        <span class="tab-title">Historique</span>
        <span class="tab-desc">{{ documents.length }} documents</span>
      </div>
    </button>
  </div>

  <!-- CORRECTION COMPLÃˆTE -->
  <div class="redaction-workspace" *ngIf="activeMainTab === 'correction'">
    <div class="input-section">
      <div class="section-card">
        <div class="card-header">
          <h2 class="section-title">ğŸ“„ Ton texte</h2>
          <span class="section-badge">Ã‰tape 1</span>
        </div>

        <div class="tab-container">
          <button class="tab-btn" [class.active]="activeInputTab === 'text'"
            (click)="activeInputTab = 'text'">
            <span class="tab-icon">âœï¸</span>
            Coller du texte
          </button>
          <button class="tab-btn" [class.active]="activeInputTab === 'file'"
            (click)="activeInputTab = 'file'">
            <span class="tab-icon">ğŸ“</span>
            Importer un fichier
          </button>
        </div>

        <div class="tab-content" *ngIf="activeInputTab === 'text'">
          <textarea class="text-input"
            placeholder="Ã‰cris ou colle ton texte ici... (essais, dissertations, emails, articles, etc.)"
            rows="12" [(ngModel)]="inputText"></textarea>
          <div class="input-info">
            <span class="char-count">{{ inputText?.length || 0 }} caractÃ¨res</span>
            <button *ngIf="inputText" class="clear-text-btn" (click)="clearText()">
              Effacer tout
            </button>
          </div>
        </div>

        <div class="tab-content" *ngIf="activeInputTab === 'file'">
          <div class="upload-zone" (click)="fileInput.click()">
            <input #fileInput type="file" class="file-input" accept=".pdf,.docx,.txt,.doc"
              (change)="onFileSelected($event)" hidden />
            <div class="upload-content">
              <span class="upload-icon">ğŸ“</span>
              <p class="upload-text">
                <strong>Clique pour choisir un fichier</strong> ou glisse-le ici
              </p>
              <p class="upload-formats">PDF, DOCX, TXT, DOC (Max 10MB)</p>
            </div>
          </div>

          <div class="selected-file" *ngIf="selectedFile">
            <div class="file-info">
              <span class="file-icon">ğŸ“„</span>
              <div class="file-details">
                <p class="file-name">{{ selectedFile.name }}</p>
                <p class="file-size">{{ formatFileSize(selectedFile.size) }}</p>
              </div>
            </div>
            <button class="remove-file-btn" (click)="removeFile()">
              <span>âœ•</span>
            </button>
          </div>
        </div>

        <button class="generate-btn" [disabled]="isProcessing || (!inputText && !selectedFile)"
          (click)="analyzeText()">
          <span *ngIf="!isProcessing">ğŸ” Analyser le texte</span>
          <span *ngIf="isProcessing" class="loading-content">
            <span class="spinner"></span>
            Analyse en cours...
          </span>
        </button>
      </div>
    </div>

    <div class="output-section">
      <div class="section-card">
        <div class="card-header">
          <h2 class="section-title">âœ¨ RÃ©sultats</h2>
          <span class="section-badge">Ã‰tape 2</span>
        </div>

        <div class="tab-container">
          <button class="tab-btn" [class.active]="activeTab === 'correction'"
            (click)="activeTab = 'correction'">
            <span class="tab-icon">âœ…</span>
            Correction
          </button>
          <button class="tab-btn" [class.active]="activeTab === 'suggestions'"
            (click)="activeTab = 'suggestions'">
            <span class="tab-icon">ğŸ’¡</span>
            Suggestions ({{ suggestions.length }})
          </button>
        </div>

        <div class="empty-state" *ngIf="!correctedText && !isProcessing">
          <span class="empty-icon">ğŸ“</span>
          <p class="empty-text">Tes corrections apparaÃ®tront ici</p>
          <p class="empty-subtext">Entre du texte et lance l'analyse pour commencer</p>
        </div>

        <div class="loading-state" *ngIf="isProcessing">
          <div class="loading-animation">
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
            <div class="loading-dot"></div>
          </div>
          <p class="loading-text">Analyse grammaticale et stylistique en cours...</p>
        </div>

        <div class="result-content" *ngIf="correctedText && !isProcessing && activeTab === 'correction'">
          <div class="summary-actions">
            <button class="action-btn" (click)="copyText()">
              <span>ğŸ“‹</span>
              Copier
            </button>
            <button class="action-btn" (click)="downloadText()">
              <span>ğŸ’¾</span>
              TÃ©lÃ©charger
            </button>
          </div>

          <div class="summary-text">
            <h3 class="summary-title">ğŸ“Œ Texte corrigÃ©</h3>
            <div class="summary-body">
              <p>{{ correctedText }}</p>
            </div>
          </div>
        </div>

        <div class="result-content suggestions-content"
          *ngIf="correctedText && !isProcessing && activeTab === 'suggestions'">
          <div class="empty-state" *ngIf="suggestions.length === 0">
            <span class="empty-icon">ğŸ‰</span>
            <p class="empty-text">Aucune suggestion</p>
            <p class="empty-subtext">Ton texte semble dÃ©jÃ  bien rÃ©digÃ© !</p>
          </div>

          <div class="suggestions-list" *ngIf="suggestions.length > 0">
            <div class="suggestion-card" *ngFor="let suggestion of suggestions">
              <div class="suggestion-header">
                <div class="suggestion-type">
                  <span class="suggestion-icon">{{ getTypeIcon(suggestion.type) }}</span>
                  <span class="suggestion-badge">{{ getTypeLabel(suggestion.type) }}</span>
                </div>
              </div>

              <p class="suggestion-rule">{{ suggestion.rule }}</p>

              <div class="suggestion-comparison">
                <div class="comparison-item error">
                  <span class="comparison-icon">âŒ</span>
                  <span class="comparison-text">{{ suggestion.original }}</span>
                </div>
                <div class="comparison-item success">
                  <span class="comparison-icon">âœ…</span>
                  <span class="comparison-text">{{ suggestion.correction }}</span>
                </div>
              </div>

              <button class="apply-btn" (click)="applySuggestion(suggestion)">
                Appliquer la correction
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- CORRECTION RAPIDE -->
  <div class="quick-grammar-container" *ngIf="activeMainTab === 'grammar'">
    <div class="section-card full-width">
      <div class="card-header">
        <h2 class="section-title">âš¡ Correction Grammaticale Rapide</h2>
        <span class="section-badge">InstantanÃ©</span>
      </div>

      <div class="grammar-grid">
        <div class="grammar-section">
          <label class="grammar-label">
            <span class="label-icon">âœï¸</span>
            Texte original
          </label>
          <textarea class="text-input" placeholder="Entre ton texte Ã  corriger..." rows="10"
            [(ngModel)]="grammarInputText"></textarea>
          <div class="input-info">
            <span class="char-count">{{ grammarInputText?.length || 0 }} caractÃ¨res</span>
          </div>
        </div>

        <div class="grammar-section">
          <label class="grammar-label">
            <span class="label-icon">âœ…</span>
            Texte corrigÃ©
          </label>
          <div class="output-box" *ngIf="!grammarCorrectedText && !isGrammarProcessing">
            <div class="empty-state-small">
              <span class="empty-icon">ğŸ“</span>
              <p class="empty-text">La correction apparaÃ®tra ici</p>
            </div>
          </div>
          <div class="output-box" *ngIf="isGrammarProcessing">
            <div class="loading-state-small">
              <div class="spinner-large"></div>
              <p class="loading-text">Correction en cours...</p>
            </div>
          </div>
          <div class="output-box result-box" *ngIf="grammarCorrectedText && !isGrammarProcessing">
            <p class="corrected-text">{{ grammarCorrectedText }}</p>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button class="generate-btn" [disabled]="isGrammarProcessing || !grammarInputText.trim()"
          (click)="correctGrammarQuick()">
          <span *ngIf="!isGrammarProcessing">âš¡ Corriger</span>
          <span *ngIf="isGrammarProcessing" class="loading-content">
            <span class="spinner"></span>
            Correction...
          </span>
        </button>
        <button class="action-btn secondary" [disabled]="!grammarCorrectedText" (click)="copyGrammarText()">
          <span>ğŸ“‹</span>
          Copier
        </button>
        <button class="action-btn secondary" (click)="clearGrammar()">
          <span>ğŸ—‘ï¸</span>
          Effacer
        </button>
      </div>
    </div>
  </div>

  <!-- TRADUCTION -->
  <div class="translation-container" *ngIf="activeMainTab === 'translation'">
    <div class="section-card full-width">
      <div class="card-header">
        <h2 class="section-title">ğŸŒ Traduction</h2>
        <span class="section-badge">FR â‡„ EN</span>
      </div>

      <div class="translation-grid">
        <div class="translation-section">
          <div class="language-header">
            <label class="grammar-label">
              <span class="label-icon">{{ translationDirection === 'en-fr' ? 'ğŸ‡¬ğŸ‡§' : 'ğŸ‡«ğŸ‡·' }}</span>
              {{ translationDirection === 'en-fr' ? 'Anglais' : 'FranÃ§ais' }}
            </label>
          </div>
          <textarea class="text-input" placeholder="Entre ton texte Ã  traduire..." rows="10"
            [(ngModel)]="translationInputText"></textarea>
          <div class="input-info">
            <span class="char-count">{{ translationInputText?.length || 0 }} caractÃ¨res</span>
          </div>
        </div>

        <div class="swap-container">
          <button class="swap-btn" (click)="swapTranslationDirection()">
            <span class="swap-icon">â‡„</span>
          </button>
        </div>

        <div class="translation-section">
          <div class="language-header">
            <label class="grammar-label">
              <span class="label-icon">{{ translationDirection === 'en-fr' ? 'ğŸ‡«ğŸ‡·' : 'ğŸ‡¬ğŸ‡§' }}</span>
              {{ translationDirection === 'en-fr' ? 'FranÃ§ais' : 'Anglais' }}
            </label>
          </div>
          <div class="output-box" *ngIf="!translationOutputText && !isTranslationProcessing">
            <div class="empty-state-small">
              <span class="empty-icon">ğŸŒ</span>
              <p class="empty-text">La traduction apparaÃ®tra ici</p>
            </div>
          </div>
          <div class="output-box" *ngIf="isTranslationProcessing">
            <div class="loading-state-small">
              <div class="spinner-large"></div>
              <p class="loading-text">Traduction en cours...</p>
            </div>
          </div>
          <div class="output-box result-box" *ngIf="translationOutputText && !isTranslationProcessing">
            <p class="corrected-text">{{ translationOutputText }}</p>
          </div>
        </div>
      </div>

      <div class="action-buttons">
        <button class="generate-btn" [disabled]="isTranslationProcessing || !translationInputText.trim()"
          (click)="translateText()">
          <span *ngIf="!isTranslationProcessing">ğŸŒ Traduire</span>
          <span *ngIf="isTranslationProcessing" class="loading-content">
            <span class="spinner"></span>
            Traduction...
          </span>
        </button>
        <button class="action-btn secondary" [disabled]="!translationOutputText" (click)="copyTranslation()">
          <span>ğŸ“‹</span>
          Copier
        </button>
        <button class="action-btn secondary" (click)="clearTranslation()">
          <span>ğŸ—‘ï¸</span>
          Effacer
        </button>
      </div>
    </div>
  </div>

  <!-- PARAPHRASE -->

  <!-- ADAPTATION DE STYLE -->
<div class="style-adaptation-container" *ngIf="activeMainTab === 'style'">
  <div class="section-card full-width">
    <div class="card-header">
      <h2 class="section-title">ğŸ­ Adaptation de Style</h2>
      <span class="section-badge">Personnalisation avancÃ©e</span>
    </div>

    <!-- SÃ©lection du style -->
    <div class="style-selection-section">
      <label class="grammar-label">
        <span class="label-icon">ğŸ¯</span>
        Choisir un style
      </label>
      <div class="style-grid">
        <button class="style-card"
                *ngFor="let style of availableStyles"
                [class.active]="selectedStyle === style.value"
                (click)="selectedStyle = style.value">
          <span class="style-icon">{{ style.icon }}</span>
          <span class="style-name">{{ style.label }}</span>
          <span class="style-desc">{{ style.description }}</span>
        </button>
      </div>
    </div>

    <!-- Zone de texte -->
    <div class="style-input-section">
      <label class="grammar-label">
        <span class="label-icon">âœï¸</span>
        Texte Ã  adapter
      </label>
      <textarea class="text-input"
                placeholder="Entre ton texte Ã  adapter..."
                rows="8"
                [(ngModel)]="styleInputText"></textarea>
      <div class="input-info">
        <span class="char-count">{{ styleInputText?.length || 0 }} caractÃ¨res</span>
      </div>
    </div>

    <!-- Bouton de gÃ©nÃ©ration -->
    <button class="generate-btn"
            [disabled]="isStyleAdaptationProcessing || !styleInputText.trim()"
            (click)="adaptStyle()">
      <span *ngIf="!isStyleAdaptationProcessing">ğŸ­ Adapter le style</span>
      <span *ngIf="isStyleAdaptationProcessing" class="loading-content">
        <span class="spinner"></span>
        Adaptation en cours...
      </span>
    </button>

    <!-- RÃ©sultats -->
    <div class="style-results" *ngIf="styleAdaptationResults && !isStyleAdaptationProcessing">
      <h3 class="results-title">âœ¨ RÃ©sultats de l'adaptation</h3>

      <div class="result-steps">
        <!-- Ã‰tape 1: Correction -->
        <div class="result-step">
          <div class="step-header">
            <span class="step-number">1</span>
            <span class="step-title">Correction grammaticale</span>
            <button class="copy-btn-small" (click)="copyStyleText(styleAdaptationResults.corrected_text)">
              ğŸ“‹ Copier
            </button>
          </div>
          <div class="step-content">
            <p class="step-text">{{ styleAdaptationResults.corrected_text }}</p>
          </div>
        </div>

        <!-- Ã‰tape 2: Paraphrase -->
        <div class="result-step">
          <div class="step-header">
            <span class="step-number">2</span>
            <span class="step-title">Paraphrase</span>
            <button class="copy-btn-small" (click)="copyStyleText(styleAdaptationResults.paraphrased_text)">
              ğŸ“‹ Copier
            </button>
          </div>
          <div class="step-content">
            <p class="step-text">{{ styleAdaptationResults.paraphrased_text }}</p>
          </div>
        </div>

        <!-- Ã‰tape 3: Adaptation finale -->
        <div class="result-step final-step">
          <div class="step-header">
            <span class="step-number">3</span>
            <span class="step-title">Style {{ getStyleLabel(styleAdaptationResults.style) }}</span>
            <button class="copy-btn-small primary" (click)="copyStyleText(styleAdaptationResults.adapted_text)">
              ğŸ“‹ Copier
            </button>
          </div>
          <div class="step-content">
            <p class="step-text adapted">{{ styleAdaptationResults.adapted_text }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Ã‰tat vide -->
    <div class="empty-state" *ngIf="!styleAdaptationResults && !isStyleAdaptationProcessing">
      <span class="empty-icon">ğŸ­</span>
      <p class="empty-text">Tes adaptations de style apparaÃ®tront ici</p>
      <p class="empty-subtext">Choisis un style et entre du texte pour commencer</p>
    </div>

    <!-- Ã‰tat chargement -->
    <div class="loading-state" *ngIf="isStyleAdaptationProcessing">
      <div class="loading-animation">
        <div class="loading-dot"></div>
        <div class="loading-dot"></div>
        <div class="loading-dot"></div>
      </div>
      <p class="loading-text">Adaptation du style en cours...</p>
      <p class="loading-subtext">Correction â†’ Paraphrase â†’ Adaptation</p>
    </div>

    <!-- Bouton effacer -->
    <button class="action-btn secondary full-width-btn"
            *ngIf="styleAdaptationResults"
            (click)="clearStyle()">
      <span>ğŸ—‘ï¸</span>
      Effacer tout
    </button>
  </div>
</div>
  <div class="paraphrase-container" *ngIf="activeMainTab === 'paraphrase'">
    <div class="section-card full-width">
      <div class="card-header">
        <h2 class="section-title">ğŸ”„ Paraphrase</h2>
        <span class="section-badge">3 Versions</span>
      </div>

      <div class="paraphrase-input-section">
        <label class="grammar-label">
          <span class="label-icon">âœï¸</span>
          Texte Ã  paraphraser
        </label>
        <textarea class="text-input" placeholder="Entre ton texte Ã  reformuler..." rows="6"
          [(ngModel)]="paraphraseInputText"></textarea>
        <div class="input-info">
          <span class="char-count">{{ paraphraseInputText?.length || 0 }} caractÃ¨res</span>
        </div>
      </div>

      <button class="generate-btn" [disabled]="isParaphraseProcessing || !paraphraseInputText.trim()"
        (click)="paraphraseText()">
        <span *ngIf="!isParaphraseProcessing">ğŸ”„ GÃ©nÃ©rer des paraphrases</span>
        <span *ngIf="isParaphraseProcessing" class="loading-content">
          <span class="spinner"></span>
          GÃ©nÃ©ration en cours...
        </span>
      </button>

      <div class="paraphrase-results" *ngIf="paraphraseResults.length > 0 && !isParaphraseProcessing">
        <h3 class="results-title">âœ¨ Propositions de reformulation</h3>
        <div class="paraphrase-cards">
          <div class="paraphrase-card" *ngFor="let result of paraphraseResults; let i = index">
            <div class="paraphrase-header">
              <span class="paraphrase-number">Version {{ i + 1 }}</span>
              <button class="copy-paraphrase-btn" (click)="copyParaphrase(result)">
                <span>ğŸ“‹</span>
                Copier
              </button>
            </div>
            <p class="paraphrase-text">{{ result }}</p>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="paraphraseResults.length === 0 && !isParaphraseProcessing">
        <span class="empty-icon">ğŸ”„</span>
        <p class="empty-text">Tes paraphrases apparaÃ®tront ici</p>
        <p class="empty-subtext">Entre du texte et lance la gÃ©nÃ©ration</p>
      </div>

      <div class="loading-state" *ngIf="isParaphraseProcessing">
        <div class="loading-animation">
          <div class="loading-dot"></div>
          <div class="loading-dot"></div>
          <div class="loading-dot"></div>
        </div>
        <p class="loading-text">GÃ©nÃ©ration de reformulations crÃ©atives...</p>
      </div>

      <button class="action-btn secondary full-width-btn" *ngIf="paraphraseResults.length > 0"
        (click)="clearParaphrase()">
        <span>ğŸ—‘ï¸</span>
        Effacer tout
      </button>
    </div>
  </div>

  <!-- HISTORIQUE -->
  <div class="history-container" *ngIf="activeMainTab === 'history'">
    <div class="section-card full-width">
      <div class="card-header">
        <h2 class="section-title">ğŸ“š Historique des documents</h2>
        <span class="section-badge">{{ documents.length }} documents</span>
      </div>

      <div class="history-controls" *ngIf="documents.length > 0">
        <div class="search-bar">
          <span class="search-icon">ğŸ”</span>
          <input type="text" class="search-input" placeholder="Rechercher un document..."
            [(ngModel)]="searchQuery" (input)="onSearchChange()" />
        </div>

        <div class="filter-buttons">
          <button class="filter-btn" [class.active]="selectedFilter === 'all'"
            (click)="onFilterChange('all')">
            Tous ({{ documents.length }})
          </button>
          <button class="filter-btn filter-success" [class.active]="selectedFilter === 'corrected'"
            (click)="onFilterChange('corrected')">
            âœ“ CorrigÃ©s ({{ getCorrectedCount() }})
          </button>
          <button class="filter-btn filter-pending" [class.active]="selectedFilter === 'uncorrected'"
            (click)="onFilterChange('uncorrected')">
            â³ En attente ({{ getUncorrectedCount() }})
          </button>
        </div>
      </div>

      <div class="loading-state" *ngIf="isLoadingHistory">
        <div class="spinner-large"></div>
        <p class="loading-text">Chargement de l'historique...</p>
      </div>

      <div class="empty-state" *ngIf="!isLoadingHistory && documents.length === 0">
        <span class="empty-icon">ğŸ“­</span>
        <p class="empty-text">Aucun document trouvÃ©</p>
        <p class="empty-subtext">Commence par analyser ton premier texte</p>
      </div>

      <div class="empty-state" *ngIf="!isLoadingHistory && documents.length > 0 && filteredDocuments.length === 0">
        <span class="empty-icon">ğŸ”</span>
        <p class="empty-text">Aucun rÃ©sultat</p>
        <p class="empty-subtext">Essaie avec d'autres mots-clÃ©s</p>
      </div>

      <div class="documents-grid" *ngIf="!isLoadingHistory && filteredDocuments.length > 0">
        <div class="document-card" *ngFor="let doc of filteredDocuments">
          <div class="document-status" [class.corrected]="doc.isCorrected" [class.pending]="!doc.isCorrected">
            {{ doc.isCorrected ? 'âœ“ CorrigÃ©' : 'â³ En attente' }}
          </div>

          <h3 class="document-title">{{ doc.title }}</h3>

          <div class="document-meta">
            <span class="meta-item">
              <span class="meta-icon">ğŸ“…</span>
              {{ formatDate(doc.createdAt) }}
            </span>
            <span class="meta-item" *ngIf="doc.fileName">
              <span class="meta-icon">ğŸ“</span>
              {{ doc.fileName }}
            </span>
          </div>

          <div class="document-preview">
            {{ getPreviewText(doc.originalContent) }}
          </div>

          <div class="document-stats" *ngIf="doc.isCorrected && doc.totalSuggestions">
            <span class="stat-item">
              <span class="stat-icon">ğŸ’¡</span>
              {{ doc.totalSuggestions }} suggestions
            </span>
          </div>

          <div class="document-actions">
            <button class="action-btn-small" (click)="viewDocumentDetails(doc)" *ngIf="doc.isCorrected">
              <span>ğŸ‘ï¸</span>
              Voir
            </button>
            <button class="action-btn-small action-danger" (click)="deleteDocument(doc.id)">
              <span>ğŸ—‘ï¸</span>
              Supprimer
            </button>
          </div>
        </div>
      </div>

      <div class="results-count" *ngIf="!isLoadingHistory && filteredDocuments.length > 0">
        Affichage de {{ filteredDocuments.length }} sur {{ documents.length }} document(s)
      </div>
    </div>
  </div>

  <!-- MODAL DÃ‰TAILS -->
  <div class="modal-overlay" *ngIf="showDetailModal" (click)="closeDetailModal()">
    <div class="modal-card" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">ğŸ“„ {{ selectedDocument?.title }}</h2>
        <button class="modal-close" (click)="closeDetailModal()">Ã—</button>
      </div>

      <div class="modal-body" *ngIf="selectedDocument">
        <div class="modal-section">
          <h3 class="modal-section-title">ğŸ“ Texte original</h3>
          <div class="modal-text-box">
            {{ selectedDocument.originalContent }}
          </div>
        </div>

        <div class="modal-section" *ngIf="selectedDocument.isCorrected && selectedDocument.correctedContent">
          <h3 class="modal-section-title">âœ¨ Texte corrigÃ©</h3>
          <div class="modal-text-box corrected">
            {{ selectedDocument.correctedContent }}
          </div>
        </div>

        <div class="modal-meta">
          <div class="meta-row">
            <span class="meta-label">Date de crÃ©ation:</span>
            <span class="meta-value">{{ formatDate(selectedDocument.createdAt) }}</span>
          </div>
          <div class="meta-row" *ngIf="selectedDocument.lastCorrectedAt">
            <span class="meta-label">DerniÃ¨re correction:</span>
            <span class="meta-value">{{ formatDate(selectedDocument.lastCorrectedAt) }}</span>
          </div>
          <div class="meta-row" *ngIf="selectedDocument.totalSuggestions">
            <span class="meta-label">Suggestions:</span>
            <span class="meta-value">{{ selectedDocument.totalSuggestions }}</span>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="modal-btn" (click)="closeDetailModal()">Fermer</button>
      </div>
    </div>
  </div>
</div>
